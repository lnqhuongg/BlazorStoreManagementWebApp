<div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content" style="border: none; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.1);">
            <!-- Header -->
            <div class="modal-header" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: none;">
                <h1 class="modal-title fs-5" id="addProductLabel" style="color: white; font-weight: 700;">
                    @ModalTitle
                </h1>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Body -->
            <div class="modal-body" style="padding: 2rem;">
                <div class="row g-3">
                    <!-- Tên sản phẩm -->
                    <div class="col-md-6">
                        <label for="productName" class="form-label" style="font-weight:600; color:#065f46; margin-bottom:0.75rem;">
                            Tên sản phẩm <span style="color:#ef4444;">*</span>
                        </label>
                        @if(Mode == 0)
                        {
                            <input disabled @bind="productDTO.ProductName" type="text" class="form-control" id="productName" placeholder="Nhập tên sản phẩm..."
                                   style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem;">
                        } else
                        {
                            <input @bind="productDTO.ProductName" type="text" class="form-control" id="productName" placeholder="Nhập tên sản phẩm..."
                                   style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem;">
                        }
                        @* <small class="form-text" style="color:#6b7280;">Tên sản phẩm không được để trống</small> *@
                    </div>

                    <!-- Barcode -->
                    @if(Mode == 0)
                    {
                        <div class="col-md-6">
                            <label for="barcode" class="form-label" style="font-weight:600; color:#065f46; margin-bottom:0.75rem;">
                                Barcode <span style="color:#ef4444;">*</span>
                            </label>
                            @if(Mode == 0)
                            {
                                <input disabled @bind="productDTO.Barcode" type="text" class="form-control" id="barcode" placeholder="Nhập mã barcode..."
                                       style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem;">
                            } else
                            {
                                <input @bind="productDTO.Barcode" type="text" class="form-control" id="barcode" placeholder="Nhập mã barcode..."
                                       style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem;">
                            }
                        </div>
                    }
                    
                    <!-- Loại sản phẩm -->
                    <div class="col-md-6">
                        <label for="categoryId" class="form-label" style="font-weight:600; color:#065f46; margin-bottom:0.75rem;">
                            Loại sản phẩm <span style="color:#ef4444;">*</span>
                        </label>
                        @if(Mode == 0)
                        {
                            <select disabled @bind="productDTO.CategoryID" class="form-select" id="categoryId"
                                    style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem; color:#065f46;">
                                <option value="0">-- Chọn loại --</option>
                                @if (LSPData != null && LSPData.Count > 0)
                                {
                                    @foreach (var item in LSPData)
                                    {
                                        <option @key="item.CategoryId" value="@item.CategoryId">@item.CategoryName</option>
                                    }
                                }
                            </select>
                        } else
                        {
                            <select @bind="productDTO.CategoryID" class="form-select" id="categoryId"
                                    style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem; color:#065f46;">
                                <option value="0">-- Chọn loại --</option>
                                @if (LSPData != null && LSPData.Count > 0)
                                {
                                    @foreach (var item in LSPData)
                                    {
                                        <option @key="item.CategoryId" value="@item.CategoryId">@item.CategoryName</option>
                                    }
                                }
                            </select>
                        }
                    </div>

                    <!-- Nhà cung cấp -->
                    <div class="col-md-6">
                        <label for="supplierId" class="form-label" style="font-weight:600; color:#065f46; margin-bottom:0.75rem;">
                            Nhà cung cấp
                        </label>
                        @if(Mode == 0)
                        {
                            <select disabled @bind="productDTO.SupplierID" class="form-select" id="supplierId"
                                    style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem; color:#065f46;">
                                <option value="0">-- Chọn nhà cung cấp --</option>
                                @if (NCCData != null && NCCData.Count > 0)
                                {
                                    @foreach (var item in NCCData)
                                    {
                                        <option @key="item.SupplierId" value="@item.SupplierId">@item.Name</option>
                                    }
                                }
                            </select>
                        } else
                        {
                            <select @bind="productDTO.SupplierID" class="form-select" id="supplierId"
                                    style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem; color:#065f46;">
                                <option value="0">-- Chọn nhà cung cấp --</option>
                                @if (NCCData != null && NCCData.Count > 0)
                                {
                                    @foreach (var item in NCCData)
                                    {
                                        <option @key="item.SupplierId" value="@item.SupplierId">@item.Name</option>
                                    }
                                }
                            </select>
                        }
                    </div>

                    <!-- Giá bán -->
                    <div class="col-md-6">
                        <label for="price" class="form-label" style="font-weight:600; color:#065f46; margin-bottom:0.75rem;">
                            Giá bán <span style="color:#ef4444;">*</span>
                        </label>
                        @if(Mode == 0)
                        {
                            <input disabled @bind="productDTO.Price" type="number" class="form-control" id="price" placeholder="Nhập giá bán..."
                                   style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem;">
                        } else
                        {
                            <input @bind="productDTO.Price" type="number" class="form-control" id="price" min="0" step="1000" placeholder="0"
                                   style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem;">
                        }
                        
                        <small class="form-text" style="color:#6b7280;">Đơn vị VNĐ</small>
                    </div>

                    <!-- Đơn vị tính -->
                    <div class="col-md-6">
                        <label for="unit" class="form-label" style="font-weight:600; color:#065f46; margin-bottom:0.75rem;">
                            Đơn vị tính <span style="color:#ef4444;">*</span>
                        </label>
                        @if(Mode == 0)
                        {
                            <select disabled @bind="productDTO.Unit" class="form-select" id="categoryId"
                                    style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem; color:#065f46;">
                                <option value="">-- Chọn đơn vị tính --</option>
                                <option value="chai">chai</option>
                                <option value="hộp">hộp</option>
                                <option value="lọ">lọ</option>
                                <option value="thùng">thùng</option>
                                <option value="chiếc">chiếc</option>
                                <option value="gói">gói</option>
                                <option value="cái">cái</option>
                                <option value="tuýp">tuýp</option>
                                <option value="lon">lon</option>
                            </select>
                        } else
                        {
                            <select @bind="productDTO.Unit" class="form-select" id="categoryId"
                                    style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem; color:#065f46;">
                                <option value="">-- Chọn đơn vị tính --</option>
                                <option value="chai">chai</option>
                                <option value="hộp">hộp</option>
                                <option value="lọ">lọ</option>
                                <option value="thùng">thùng</option>
                                <option value="chiếc">chiếc</option>
                                <option value="gói">gói</option>
                                <option value="cái">cái</option>
                                <option value="tuýp">tuýp</option>
                                <option value="lon">lon</option>
                            </select>
                        }
                    </div>

                    <!-- URL hình ảnh -->
                    <div class="col-md-12">
                        <label for="imageUrl" class="form-label" style="font-weight:600; color:#065f46; margin-bottom:0.75rem;">
                            URL Hình ảnh
                        </label>
                        @if(Mode == 0)
                        {
                            <InputFile OnChange="OnImageSelected" hidden class="form-control" id="imageUrl"
                                       accept="image/*" style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem;" />
                        } else
                        {
                            <InputFile OnChange="OnImageSelected" class="form-control" id="imageUrl"
                                       accept="image/*" style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem;" />
                        }
                        @if (!string.IsNullOrEmpty(previewImage) || !string.IsNullOrEmpty(productDTO.ImageUrl))
                        {
                            <img src="@(previewImage ?? productDTO.ImageUrl)"
                                 class="card-img-top"
                                 style="object-fit:cover; height:350px;" />
                        }
                        else
                        {
                            <div class="d-flex align-items-center justify-content-center"
                                 style="height:200px; background:#f3f4f6;">
                                <i class="fas fa-image fa-3x text-muted"></i>
                            </div>
                        }
                        <div class="card-body text-center">
                            <p class="card-text fw-semibold mb-0">
                                Tồn kho: <span class="text-success">@stock</span>
                            </p>
                        </div>
                    </div>

                    <!-- Trạng thái -->
                    <div class="col-md-12">
                        <label for="productStatus" class="form-label" style="font-weight:600; color:#065f46; margin-bottom:0.75rem;">
                            Trạng thái <span style="color:#ef4444;">*</span>
                        </label>
                        @if(Mode == 0)
                        {
                            <select disabled @bind="productDTO.Status" class="form-select" id="productStatus"
                                    style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem; color:#065f46;">
                                <option value="">-- Chọn trạng thái --</option>
                                <option value="1" selected>Hoạt động</option>
                                <option value="0">Tạm ngưng</option>
                            </select>
                        } else
                        {
                            <select @bind="productDTO.Status" class="form-select" id="productStatus"
                                    style="border:2px solid #d1fae5; border-radius:8px; padding:0.75rem 1rem; font-size:0.95rem; color:#065f46;">
                                <option value="">-- Chọn trạng thái --</option>
                                <option value="1" selected>Hoạt động</option>
                                <option value="0">Tạm ngưng</option>
                            </select>
                        }
                    </div>
                    @if(!string.IsNullOrEmpty(NameErrorMessage))
                    {
                        <span class="font-monospace fs-4 text-danger">@NameErrorMessage</span>
                    }
                    
                </div>
            </div>

            <!-- Footer -->
            <div class="modal-footer" style="border-top:1px solid #e5e7eb; padding:1.5rem;">
                <button type="button" class="btn" data-bs-dismiss="modal"
                        style="background:#e5e7eb; color:#374151; border:none; padding:0.75rem 1.5rem; border-radius:8px; font-weight:600;">
                    Hủy
                </button>
                @if(Mode != 0)
                {
                    <button type="button" class="btn btn-add" @onclick="HandleSubmit"
                            style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color:white; padding:0.75rem 1.5rem; border-radius:8px; font-weight:600;">
                        @BtnSubmit
                    </button>
                }
            </div>
        </div>
    </div>
</div>

@code { }